<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Patrocínios & Marca - F1 Manager 2025</title>

  <style>
    :root{
      --bg0:#06070b;
      --panel: rgba(10, 12, 18, .78);
      --panel2: rgba(12, 14, 22, .62);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.08);
      --text:#EAF0FF;
      --muted: rgba(234,240,255,.70);
      --muted2: rgba(234,240,255,.55);
      --accent:#00D1FF;
      --good:#29E07E;
      --warn:#FFB020;
      --bad:#FF3B5E;

      --radius: 18px;
      --shadow: 0 18px 50px rgba(0,0,0,.55);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: #000;
      overflow-y:auto; /* barra de rolagem */
    }

    .bg{
      position:fixed; inset:0;
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(0,209,255,.18), transparent 55%),
        radial-gradient(900px 600px at 85% 25%, rgba(255,59,94,.14), transparent 60%),
        radial-gradient(1200px 700px at 60% 85%, rgba(41,224,126,.10), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.86)),
        url("assets/ui/patrocinio_bg.png");
      background-size: cover;
      background-position: center;
      filter: saturate(1.05) contrast(1.05);
      z-index:-2;
    }
    .grain{
      position:fixed; inset:0;
      pointer-events:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.14'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      z-index:-1;
      opacity:.35;
    }

    .topbar{
      position:sticky;
      top:0;
      padding: 16px 14px 10px;
      z-index:20;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(0,0,0,.70), rgba(0,0,0,.20));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .topRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .back{
      appearance:none;
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      background: rgba(0,0,0,.35);
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 700;
      letter-spacing:.4px;
      cursor:pointer;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .back:active{transform: translateY(1px)}
    .titleWrap{
      flex:1;
      text-align:center;
      min-width:0;
    }
    .title{
      margin:0;
      font-size: 15px;
      letter-spacing: .10em;
      text-transform: uppercase;
      color: rgba(234,240,255,.92);
    }
    .sub{
      margin:6px 0 0;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.25;
    }

    .wrap{
      width: min(1180px, 100%);
      margin: 0 auto;
      padding: 12px 14px 28px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    @media (min-width: 900px){
      .grid{ grid-template-columns: 1.1fr .9fr; }
    }

    .panel{
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(16,18,28,.78), rgba(10,12,18,.62));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHeader{
      padding: 14px 14px 12px;
      border-bottom: 1px solid rgba(255,255,255,.07);
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:10px;
    }
    .panelHeader h2{
      margin:0;
      font-size: 13px;
      letter-spacing:.08em;
      text-transform: uppercase;
      color: rgba(234,240,255,.90);
    }
    .pill{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: rgba(234,240,255,.88);
      padding: 7px 10px;
      border-radius: 999px;
      font-size: 12px;
      display:flex;
      gap:8px;
      align-items:center;
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(0,209,255,.10);
    }

    .panelBody{ padding: 14px; }

    .cols{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    @media (min-width: 600px){
      .cols{ grid-template-columns: 1fr 1fr; }
    }

    /* containers do sistema */
    #listaSponsorsOfertas,
    #listaSponsorsAtivos{
      display:flex;
      flex-direction:column;
      gap: 12px;
      min-height: 110px;
    }

    .hint{
      margin: 10px 0 0;
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.35;
    }

    /* barra de rolagem mais “AAA” */
    ::-webkit-scrollbar{width:10px}
    ::-webkit-scrollbar-track{background: rgba(255,255,255,.06)}
    ::-webkit-scrollbar-thumb{background: rgba(255,255,255,.14); border-radius: 999px}
    ::-webkit-scrollbar-thumb:hover{background: rgba(255,255,255,.22)}
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="grain"></div>

  <header class="topbar">
    <div class="topRow">
      <button class="back" id="btnVoltar">VOLTAR</button>

      <div class="titleWrap">
        <h1 class="title">PATROCÍNIOS &amp; MARCA</h1>
        <p class="sub">Assine contratos, cumpra metas e aumente o caixa. Offline, integrado ao save do jogo.</p>
      </div>

      <div style="width:110px"></div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <div class="panel">
        <div class="panelHeader">
          <h2>Ofertas disponíveis</h2>
          <div class="pill"><span class="dot"></span><span>Selecione um patrocinador</span></div>
        </div>
        <div class="panelBody">
          <div id="listaSponsorsOfertas"></div>
          <div class="hint">
            Dica: contratos melhores aparecem conforme reputação e desempenho. (No modo offline, a reputação é simulada e pode ser ligada às corridas depois.)
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="panelHeader">
          <h2>Status financeiro</h2>
          <div class="pill"><span class="dot" style="background:var(--warn); box-shadow:0 0 0 4px rgba(255,176,32,.10)"></span><span>Contrato ativo &amp; caixa</span></div>
        </div>
        <div class="panelBody">
          <div id="listaSponsorsAtivos"></div>
          <div class="hint">
            Como funciona:
            <br>• Patrocinador paga semanalmente (simulado offline).
            <br>• Metas e bônus ficam registrados para a carreira.
            <br>• Você pode ligar isso ao resultado das corridas depois.
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Dependências -->
  <script src="economySystem.js"></script>
  <script src="sponsorSystem.js"></script>

  <script>
    // Helper: querystring
    function getParam(name){
      try{
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      }catch(e){
        return null;
      }
    }

    // Garantir team no localStorage (pra outras telas)
    (function initTeam(){
      const teamQS = getParam("userTeam");
      if(teamQS) localStorage.setItem("f1m_userTeam", teamQS);
      if(!localStorage.getItem("f1m_userTeam")) localStorage.setItem("f1m_userTeam", "mercedes");
    })();

    // Voltar para lobby preservando userTeam
    document.getElementById("btnVoltar").addEventListener("click", ()=>{
      const team = localStorage.getItem("f1m_userTeam") || "mercedes";
      window.location.href = "lobby.html?userTeam=" + encodeURIComponent(team);
    });

    // ✅ RENDER CORRETO (corrige o “em branco”)
    (function boot(){
      try{
        if(!window.SponsorSystem){
          console.error("SponsorSystem não carregou. Verifique sponsorSystem.js");
          return;
        }
        // garante economia, cria estado e ofertas
        window.SponsorSystem.renderInto("listaSponsorsOfertas", "listaSponsorsAtivos");
      }catch(err){
        console.error("Erro ao iniciar Patrocínios:", err);
      }
    })();
  </script>
</body>
</html>